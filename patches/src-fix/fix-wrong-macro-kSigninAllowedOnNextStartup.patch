From: Wengling Chen <feiyu2817@gmail.com>
Date: Fri, 10 Jan 2020 23:04:00 -0500
Subject: Fix wrong macro definition related to kSigninAllowedOnNextStartup

---
 .../policy/browser_signin_policy_handler.cc        | 23 ----------------------
 .../configuration_policy_handler_list_factory.cc   | 10 ----------
 2 files changed, 33 deletions(-)

diff --git a/chrome/browser/policy/browser_signin_policy_handler.cc b/chrome/browser/policy/browser_signin_policy_handler.cc
--- a/chrome/browser/policy/browser_signin_policy_handler.cc
+++ b/chrome/browser/policy/browser_signin_policy_handler.cc
@@ -41,29 +41,6 @@ void BrowserSigninPolicyHandler::ApplyPolicySettings(const PolicyMap& policies,
 #if !defined(OS_LINUX)
         prefs->SetValue(prefs::kForceBrowserSignin, base::Value(true));
 #endif
-        FALLTHROUGH;
-      case BrowserSigninMode::kEnabled:
-        prefs->SetValue(
-#if defined(OS_ANDROID)
-            // The new kSigninAllowedOnNextStartup pref is only used on Desktop.
-            // Keep the old kSigninAllowed pref for Android until the policy is
-            // fully deprecated in M71 and can be removed.
-#else
-            prefs::kSigninAllowedOnNextStartup,
-#endif
-            base::Value(true));
-        break;
-      case BrowserSigninMode::kDisabled:
-        prefs->SetValue(
-#if defined(OS_ANDROID)
-            // The new kSigninAllowedOnNextStartup pref is only used on Desktop.
-            // Keep the old kSigninAllowed pref for Android until the policy is
-            // fully deprecated in M71 and can be removed.
-#else
-            prefs::kSigninAllowedOnNextStartup,
-#endif
-            base::Value(false));
-        break;
     }
   }
 }
diff --git a/chrome/browser/policy/configuration_policy_handler_list_factory.cc b/chrome/browser/policy/configuration_policy_handler_list_factory.cc
--- a/chrome/browser/policy/configuration_policy_handler_list_factory.cc
+++ b/chrome/browser/policy/configuration_policy_handler_list_factory.cc
@@ -1396,16 +1396,6 @@ std::unique_ptr<ConfigurationPolicyHandlerList> BuildHandlerList(
   signin_legacy_policies.push_back(std::make_unique<SimplePolicyHandler>(
       key::kForceBrowserSignin, prefs::kForceBrowserSignin,
       base::Value::Type::BOOLEAN));
-  signin_legacy_policies.push_back(std::make_unique<SimplePolicyHandler>(
-      key::kSigninAllowed,
-#if defined(OS_ANDROID)
-      // The new kSigninAllowedOnNextStartup pref is only used on Desktop.
-      // Keep the old kSigninAllowed pref for Android until the policy is
-      // fully deprecated in M71 and can be removed.
-#else
-      prefs::kSigninAllowedOnNextStartup,
-#endif
-      base::Value::Type::BOOLEAN));
   handlers->AddHandler(std::make_unique<LegacyPoliciesDeprecatingPolicyHandler>(
       std::move(signin_legacy_policies),
       std::make_unique<BrowserSigninPolicyHandler>(chrome_schema)));
